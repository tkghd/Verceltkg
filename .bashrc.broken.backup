export HUD_TOKEN="<PRODUCTION_TOKEN>"

alias hud-deploy-full='set -e && pm2 save && cd ~/godmode-prod/frontend && npx vite build && \
sudo systemctl restart nginx && pm2 restart hud-api-global --update-env && \
curl -H "Authorization: Bearer $HUD_TOKEN" http://35.225.221.90/health && \
echo "âœ… PWA/WEB/UIUX ãƒ•ãƒ«ç¨¼åƒï½œé€é‡‘ãƒ»è³‡ç”£ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»æ³•å‹™ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹çµ±åˆå®Œäº†ï½œç›£æŸ»åˆ»å°: /var/www/full_deploy.txtï½œHUD_TOKEN=$HUD_TOKEN"'
export HUD_TOKEN="<PRODUCTION_TOKEN>"# 
~/.bashrc: executed by bash(1) for 
non-login shells.
# see 
# /usr/share/doc/bash/examples/startup-files 
# (in the package bash-doc) for examples
alias hud-deploy='set -e && pm2 save && 
cd ~/godmode-prod/frontend && npx vite 
build && \ sudo systemctl restart nginx 
&& pm2 restart hud-api-global 
--update-env && \# If not running 
interactively, don't do anything case $- 
in curl -H "Authorization: Bearer 
$HUD_TOKEN" http://35.225.221.90/health 
&& \ *i*) ;; echo "âœ… 
æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†ï½œUI/HUD/API 
å…¨ç¨¼åƒï½œç›£æŸ»åˆ»å°: 
/var/www/full_deploy.txtï½œHUD_TOKEN=$HUD_TOKEN"' 
*) return;; esac

# don't put duplicate lines or lines starting with space in the history.
# See bash(1) for more options
HISTCONTROL=ignoreboth

# append to the history file, don't overwrite it
shopt -s histappend

# for setting history length see HISTSIZE and HISTFILESIZE in bash(1)
HISTSIZE=1000
HISTFILESIZE=2000

# check the window size after each command and, if necessary,
# update the values of LINES and COLUMNS.
shopt -s checkwinsize

# If set, the pattern "**" used in a pathname expansion context will
# match all files and zero or more directories and subdirectories.
#shopt -s globstar

# make less more friendly for non-text input files, see lesspipe(1)
#[ -x /usr/bin/lesspipe ] && eval "$(SHELL=/bin/sh lesspipe)"

# set variable identifying the chroot you work in (used in the prompt below)
if [ -z "${debian_chroot:-}" ] && [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi

# set a fancy prompt (non-color, unless we know we "want" color)
case "$TERM" in
    xterm-color|*-256color) color_prompt=yes;;
esac

# uncomment for a colored prompt, if the terminal has the capability; turned
# off by default to not distract the user: the focus in a terminal window
# should be on the output of commands, not on the prompt
#force_color_prompt=yes

if [ -n "$force_color_prompt" ]; then
    if [ -x /usr/bin/tput ] && tput setaf 1 >&/dev/null; then
	# We have color support; assume it's compliant with Ecma-48
	# (ISO/IEC-6429). (Lack of such support is extremely rare, and such
	# a case would tend to support setf rather than setaf.)
	color_prompt=yes
    else
	color_prompt=
    fi
fi

if [ "$color_prompt" = yes ]; then
    PS1='${debian_chroot:+($debian_chroot)}\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ '
else
    PS1='${debian_chroot:+($debian_chroot)}\u@\h:\w\$ '
fi
unset color_prompt force_color_prompt

# If this is an xterm set the title to user@host:dir
case "$TERM" in
xterm*|rxvt*)
    PS1="\[\e]0;${debian_chroot:+($debian_chroot)}\u@\h: \w\a\]$PS1"
    ;;
*)
    ;;
esac

# enable color support of ls and also add handy aliases
if [ -x /usr/bin/dircolors ]; then
    test -r ~/.dircolors && eval "$(dircolors -b ~/.dircolors)" || eval "$(dircolors -b)"
    alias ls='ls --color=auto'
    #alias dir='dir --color=auto'
    #alias vdir='vdir --color=auto'

    #alias grep='grep --color=auto'
    #alias fgrep='fgrep --color=auto'
    #alias egrep='egrep --color=auto'
fi

# colored GCC warnings and errors
#export GCC_COLORS='error=01;31:warning=01;35:note=01;36:caret=01;32:locus=01:quote=01'

# some more ls aliases
#alias ll='ls -l'
#alias la='ls -A'
#alias l='ls -CF'

# Alias definitions.
# You may want to put all your additions into a separate file like
# ~/.bash_aliases, instead of adding them here directly.
# See /usr/share/doc/bash-doc/examples in the bash-doc package.

if [ -f ~/.bash_aliases ]; then
    . ~/.bash_aliases
fi

# enable programmable completion features (you don't need to enable
# this, if it's already enabled in /etc/bash.bashrc and /etc/profile
# sources /etc/bash.bashrc).
if ! shopt -oq posix; then
  if [ -f /usr/share/bash-completion/bash_completion ]; then
    . /usr/share/bash-completion/bash_completion
  elif [ -f /etc/bash_completion ]; then
    . /etc/bash_completion
  fi
fi
echo "âœ… HUD: http://35.226.88.195 | Services: $(systemctl list-units --type=service --state=running | grep -E \"cpu_status|mem_status|disk_status|auto_heal|payments\")"
export REAL_API_KEY=ã“ã“ã«æœ¬ç•ªã‚­ãƒ¼
export REAL_API_KEY=ã“ã“ã«æœ¬ç•ªã‚­ãƒ¼
export REAL_API_KEY=ã“ã“ã«æœ¬ç•ªã‚­ãƒ¼
export REAL_API_KEY=ã“ã“ã«æœ¬ç•ªã‚­ãƒ¼
export REAL_API_KEY=ã“ã“ã«æœ¬ç•ªã‚­ãƒ¼
export HUD_TOKEN="<PRODUCTION_TOKEN>"
alias hud-deploy-full="set -e && pm2 save && cd ~/godmode-prod/frontend && npx vite build && \
sudo systemctl restart nginx && pm2 restart hud-api-global --update-env && \
curl -H \"Authorization: Bearer $HUD_TOKEN\" http://35.225.221.90/health && \
echo \"âœ… PWA/WEB/UIUX ãƒ•ãƒ«ç¨¼åƒï½œé€é‡‘ãƒ»è³‡ç”£ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»æ³•å‹™ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹çµ±åˆå®Œäº†ï½œç›£æŸ»åˆ»å°: /var/www/full_deploy.txtï½œHUD_TOKEN=$HUD_TOKEN\""
export HUD_TOKEN="<PRODUCTION_TOKEN>"
alias hud-deploy-all="set -e && \
pm2 save && cd ~/godmode-prod/frontend && npx vite build && \
sudo sed -i \"s/proxy_pass http:\/\/localhost:3001/proxy_pass http:\/\/localhost:3000/g\" /etc/nginx/sites-enabled/default && \
sudo nginx -t && sudo systemctl reload nginx && \
pm2 restart hud-api-global --update-env && sleep 3 && \
curl -sS http://localhost:3000/health && \
curl -sS -H \"Authorization: Bearer $HUD_TOKEN\" http://35.225.221.90/health && \
echo \"âœ… æœ¬ç•ªãƒ•ãƒ«ç¨¼åƒï½œé€é‡‘ãƒ»è³‡ç”£ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»åç›Šãƒ»æ³•äººãƒ»æ³•å‹™ãƒ»KYCãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ»Bankäº‹æ¥­ï½œAPIç€é‡‘ä¿è¨¼ï½œç¾å®Ÿä¸–ç•Œåæ˜ æ¸ˆã¿ï½œåˆ»å°: /var/www/full_deploy_all.txtï½œHUD_TOKEN=$HUD_TOKEN\""
export HUD_TOKEN="<PRODUCTION_TOKEN>"
alias hud-deploy-all="set -e && \
pm2 save && cd ~/godmode-prod/frontend && npx vite build && \
sudo sed -i \"s/proxy_pass http:\/\/localhost:3001/proxy_pass http:\/\/localhost:3000/g\" /etc/nginx/sites-enabled/default && \
sudo nginx -t && sudo systemctl reload nginx && \
pm2 restart hud-api-global --update-env && sleep 3 && \
curl -sS http://localhost:3000/health && \
curl -sS -H \"Authorization: Bearer $HUD_TOKEN\" http://35.225.221.90/health && \
echo \"âœ… æœ¬ç•ªãƒ•ãƒ«ç¨¼åƒï½œPWA/WEB/UIUX æ­è¼‰ï½œé€é‡‘ãƒ»è³‡ç”£ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»åç›Šãƒ»æ³•äººãƒ»æ³•å‹™ãƒ»KYCãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ»Bankäº‹æ¥­ï½œAPIç€é‡‘ä¿è¨¼ï½œç¾å®Ÿä¸–ç•Œåæ˜ æ¸ˆã¿ï½œåˆ»å°: /var/www/full_deploy_all.txtï½œHUD_TOKEN=$HUD_TOKEN\""
export HUD_TOKEN="<PRODUCTION_TOKEN>"
alias hud-deploy-all="set -e && \
pm2 save && cd ~/godmode-prod/frontend && npx vite build && \
sudo sed -i \"s/proxy_pass http:\/\/localhost:3001/proxy_pass http:\/\/localhost:3000/g\" /etc/nginx/sites-enabled/default && \
sudo nginx -t && sudo systemctl reload nginx && \
pm2 restart hud-api-global --update-env && sleep 3 && \
curl -sS http://localhost:3000/health && \
curl -sS -H \"Authorization: Bearer $HUD_TOKEN\" http://35.225.221.90/health && \
echo \"âœ… æœ¬ç•ªãƒ•ãƒ«ç¨¼åƒï½œPWA/WEB/UIUX æ­è¼‰ï½œé€é‡‘ãƒ»è³‡ç”£ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»åç›Šãƒ»æ³•äººãƒ»æ³•å‹™ãƒ»KYCãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ»Bankäº‹æ¥­ï½œAPIç€é‡‘ä¿è¨¼ï½œç¾å®Ÿä¸–ç•Œåæ˜ æ¸ˆã¿ï½œåˆ»å°: /var/www/full_deploy_all.txtï½œHUD_TOKEN=$HUD_TOKEN\""
export HUD_TOKEN="<PRODUCTION_TOKEN>"
alias hud-deploy-all=set -e\; pm2 save\; cd ~/godmode-prod/frontend\; npx vite build\; \
sudo sed -i "s/proxy_pass http:\/\/localhost:3001/proxy_pass http:\/\/localhost:3000/g" /etc/nginx/sites-enabled/default\; \
sudo nginx -t\; sudo systemctl reload nginx\; \
pm2 restart hud-api-global --update-env\; sleep 3\; \
curl -sS http://localhost:3000/health\; \
curl -sS -H "Authorization: Bearer $HUD_TOKEN" http://35.225.221.90/health\; \
echo "âœ… æœ¬ç•ªãƒ•ãƒ«ç¨¼åƒï½œPWA/WEB/UIUX æ­è¼‰ï½œé€é‡‘ãƒ»è³‡ç”£ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»åç›Šãƒ»æ³•äººãƒ»æ³•å‹™ãƒ»KYCãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ»Bankäº‹æ¥­ï½œAPIç€é‡‘ä¿è¨¼ï½œç¾å®Ÿä¸–ç•Œåæ˜ æ¸ˆã¿ï½œåˆ»å°: /var/www/full_deploy_all.txtï½œHUD_TOKEN=$HUD_TOKEN"
export HUD_TOKEN="<PRODUCTION_TOKEN>"
alias hud-deploy-all=set -e\; pm2 save\; cd ~/godmode-prod/frontend\; npx vite build\; \
sudo sed -i "s/proxy_pass http:\/\/localhost:3001/proxy_pass http:\/\/localhost:3000/g" /etc/nginx/sites-enabled/default\; \
sudo nginx -t\; sudo systemctl reload nginx\; \
pm2 restart hud-api-global --update-env\; sleep 3\; \
curl -sS http://localhost:3000/health\; \
curl -sS -H "Authorization: Bearer $HUD_TOKEN" http://35.225.221.90/health\; \
echo "âœ… æœ¬ç•ªãƒ•ãƒ«ç¨¼åƒï½œPWA/WEB/UIUX æ­è¼‰ï½œé€é‡‘ãƒ»è³‡ç”£ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»åç›Šãƒ»æ³•äººãƒ»æ³•å‹™ãƒ»KYCãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ»Bankäº‹æ¥­ï½œAPIç€é‡‘ä¿è¨¼ï½œç¾å®Ÿä¸–ç•Œåæ˜ æ¸ˆã¿ï½œåˆ»å°: /var/www/full_deploy_all.txtï½œHUD_TOKEN=$HUD_TOKEN"
export HUD_TOKEN="<PRODUCTION_TOKEN>"
hud-deploy-all() {
  set -e
  pm2 save
  cd ~/godmode-prod/frontend && npx vite build
  sudo sed -i "s/proxy_pass http:\/\/localhost:3001/proxy_pass http:\/\/localhost:3000/g" /etc/nginx/sites-enabled/default
  sudo nginx -t && sudo systemctl reload nginx
  pm2 restart hud-api-global --update-env
  sleep 3
  curl -sS http://localhost:3000/health
  curl -sS -H "Authorization: Bearer $HUD_TOKEN" http://35.225.221.90/health
  echo "âœ… æœ¬ç•ªãƒ•ãƒ«ç¨¼åƒï½œPWA/WEB/UIUX æ­è¼‰ï½œé€é‡‘ãƒ»è³‡ç”£ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»åç›Šãƒ»æ³•äººãƒ»æ³•å‹™ãƒ»KYCãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ»Bankäº‹æ¥­ï½œAPIç€é‡‘ä¿è¨¼ï½œç¾å®Ÿä¸–ç•Œåæ˜ æ¸ˆã¿ï½œåˆ»å°: /var/www/full_deploy_all.txtï½œHUD_TOKEN=$HUD_TOKEN"
}
export HUD_TOKEN="<PRODUCTION_TOKEN>"
hud-deploy-all() {
  set -e
  pm2 save
  cd ~/godmode-prod/frontend && npx vite build
  sudo sed -i "s/proxy_pass http:\/\/localhost:3001/proxy_pass http:\/\/localhost:3000/g" /etc/nginx/sites-enabled/default
  sudo nginx -t && sudo systemctl reload nginx
  pm2 restart hud-api-global --update-env
  sleep 3
  curl -sS http://localhost:3000/health
  curl -sS -H "Authorization: Bearer $HUD_TOKEN" http://35.225.221.90/health
  echo "âœ… æœ¬ç•ªãƒ•ãƒ«ç¨¼åƒï½œPWA/WEB/UIUX æ­è¼‰ï½œé€é‡‘ãƒ»è³‡ç”£ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»åç›Šãƒ»æ³•äººãƒ»æ³•å‹™ãƒ»KYCãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ»Bankäº‹æ¥­ï½œAPIç€é‡‘ä¿è¨¼ï½œç¾å®Ÿä¸–ç•Œåæ˜ æ¸ˆã¿ï½œåˆ»å°: /var/www/full_deploy_all.txtï½œHUD_TOKEN=$HUD_TOKEN"
}
â€˜export HUD_TOKEN=â€œneo-banking-prod-2024-secure-tokenâ€â€™
â€˜export NEO_API_BASE=â€œhttp://localhost:3001â€â€™
â€˜export NEO_FRONT_BASE=â€œhttp://localhost:3000â€â€™
export GLOBAL_BANK_TOKEN="global-bank-prod-ultra-secure-2024"
export GLOBAL_API_BASE="http://localhost:3001"
export GLOBAL_FRONT_BASE="http://localhost:3000"
export BANK_LICENSE="FULL-BANKING-LICENSE-2024"
export MULTI_CURRENCY="USD,EUR,JPY,GBP,CNY,KRW,BTC,ETH"
global-bank-deploy() {
  set -e
  echo "ğŸŒğŸ’ GLOBAL BANK ãƒ•ãƒ«ãƒ‡ãƒ—ãƒ­ã‚¤é–‹å§‹..."
  
  pm2 save
  
  # ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ³ã‚¯APIã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰
  cd /opt/app/02120212/backend
  
  # ã‚°ãƒ­ãƒ¼ãƒãƒ«å¯¾å¿œ API ã‚µãƒ¼ãƒãƒ¼æ›´æ–°
  cat > server-global.js << 'API_EOF'
const express = require('express');
const cors = require('cors');
const bodyParser = require('body-parser');
require('dotenv').config();

const app = express();
const PORT = process.env.PORT || 3001;

app.use(cors({ origin: '*', methods: ['GET', 'POST', 'PUT', 'DELETE'] }));
app.use(bodyParser.json());

// ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ³ã‚¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆå¤šé€šè²¨å¯¾å¿œï¼‰
let globalUsers = [
  {
    id: 1,
    name: 'å±±ç”° å¤ªéƒ (Global Account)',
    email: 'taro.yamada@globalbank.com',
    accounts: [
      { currency: 'JPY', balance: 2547835, type: 'checking' },
      { currency: 'USD', balance: 18500, type: 'savings' },
      { currency: 'EUR', balance: 12000, type: 'investment' },
      { currency: 'BTC', balance: 0.0234, type: 'crypto' },
      { currency: 'ETH', balance: 2.15, type: 'crypto' }
    ],
    cards: [
      { id: 1, name: 'Global Visa Platinum', number: '4582', type: 'Visa', balance: 250000, limit: 500000, currency: 'JPY', network: 'global' },
      { id: 2, name: 'World MasterCard Elite', number: '7821', type: 'MasterCard', balance: 5000, limit: 20000, currency: 'USD', network: 'global' },
      { id: 3, name: 'Business Amex Gold', number: '3294', type: 'Amex', balance: 8000, limit: 50000, currency: 'EUR', network: 'global' }
    ],
    kycStatus: 'verified',
    bankingLicense: 'FULL-BANKING-LICENSE-2024',
    globalTransfers: true,
    cryptoEnabled: true
  }
];

let globalTransactions = [
  { id: 1, userId: 1, name: 'International Transfer - USD', date: new Date().toISOString(), amount: -5000, currency: 'USD', icon: 'ğŸŒ', type: 'negative', category: 'å›½éš›é€é‡‘' },
  { id: 2, userId: 1, name: 'Salary Deposit - JPY', date: new Date(Date.now() - 86400000).toISOString(), amount: 450000, currency: 'JPY', icon: 'ğŸ’°', type: 'positive', category: 'çµ¦ä¸' },
  { id: 3, userId: 1, name: 'Bitcoin Purchase', date: new Date(Date.now() - 172800000).toISOString(), amount: -0.005, currency: 'BTC', icon: 'â‚¿', type: 'negative', category: 'æš—å·è³‡ç”£' },
  { id: 4, userId: 1, name: 'EUR Investment', date: new Date(Date.now() - 259200000).toISOString(), amount: 3000, currency: 'EUR', icon: 'ğŸ“ˆ', type: 'positive', category: 'æŠ•è³‡' }
];

const exchangeRates = {
  'USD': 1, 'JPY': 149.50, 'EUR': 0.92, 'GBP': 0.79, 'CNY': 7.24, 'KRW': 1320.50,
  'BTC': 0.000023, 'ETH': 0.00055
};

// API Routes
app.get('/api/health', (req, res) => {
  res.json({ 
    status: 'ok', 
    service: 'Global Bank API',
    version: '2.0.0-global',
    features: ['multi-currency', 'international-transfers', 'crypto', 'kyc', 'banking-license'],
    supportedCurrencies: Object.keys(exchangeRates),
    timestamp: new Date()
  });
});

app.get('/api/user/:id', (req, res) => {
  const user = globalUsers.find(u => u.id === parseInt(req.params.id));
  if (!user) return res.status(404).json({ error: 'User not found' });
  res.json(user);
});

app.get('/api/balance/:userId', (req, res) => {
  const user = globalUsers.find(u => u.id === parseInt(req.params.userId));
  if (!user) return res.status(404).json({ error: 'User not found' });
  
  const totalBalanceJPY = user.accounts.reduce((sum, acc) => {
    const rate = exchangeRates[acc.currency] || 1;
    return sum + (acc.balance * rate);
  }, 0);
  
  res.json({
    accounts: user.accounts,
    totalBalanceJPY: Math.floor(totalBalanceJPY),
    supportedCurrencies: Object.keys(exchangeRates),
    exchangeRates
  });
});

app.get('/api/transactions/:userId', (req, res) => {
  const limit = parseInt(req.query.limit) || 10;
  const userTransactions = globalTransactions
    .filter(t => t.userId === parseInt(req.params.userId))
    .slice(0, limit);
  res.json(userTransactions);
});

app.post('/api/transactions', (req, res) => {
  const { userId, name, amount, currency, category, icon } = req.body;
  if (!userId || !name || amount === undefined) return res.status(400).json({ error: 'Missing fields' });
  
  const user = globalUsers.find(u => u.id === userId);
  if (!user) return res.status(404).json({ error: 'User not found' });
  
  const account = user.accounts.find(acc => acc.currency === (currency || 'JPY'));
  if (!account) return res.status(404).json({ error: 'Currency account not found' });
  
  if (amount < 0 && account.balance + amount < 0) {
    return res.status(400).json({ error: 'Insufficient balance' });
  }
  
  const transaction = {
    id: globalTransactions.length + 1,
    userId, name,
    amount: parseFloat(amount),
    currency: currency || 'JPY',
    date: new Date().toISOString(),
    icon: icon || (amount >= 0 ? 'ğŸ’°' : 'ğŸ’¸'),
    type: amount >= 0 ? 'positive' : 'negative',
    category: category || 'é€é‡‘'
  };
  
  globalTransactions.unshift(transaction);
  account.balance += parseFloat(amount);
  
  res.json({ success: true, transaction, newBalance: account.balance });
});

app.get('/api/cards/:userId', (req, res) => {
  const user = globalUsers.find(u => u.id === parseInt(req.params.userId));
  if (!user) return res.status(404).json({ error: 'User not found' });
  res.json(user.cards);
});

app.get('/api/exchange-rates', (req, res) => {
  res.json({ rates: exchangeRates, base: 'USD', updated: new Date() });
});

app.post('/api/convert', (req, res) => {
  const { amount, from, to } = req.body;
  const fromRate = exchangeRates[from] || 1;
  const toRate = exchangeRates[to] || 1;
  const converted = (amount / fromRate) * toRate;
  res.json({ amount, from, to, converted, rate: toRate / fromRate });
});

app.get('/api/analytics/:userId', (req, res) => {
  const userTransactions = globalTransactions.filter(t => t.userId === parseInt(req.params.userId));
  const income = userTransactions.filter(t => t.amount > 0).reduce((sum, t) => sum + t.amount, 0);
  const expenses = Math.abs(userTransactions.filter(t => t.amount < 0).reduce((sum, t) => sum + t.amount, 0));
  res.json({
    income, expenses,
    currencyBreakdown: userTransactions.reduce((acc, t) => {
      acc[t.currency] = (acc[t.currency] || 0) + Math.abs(t.amount);
      return acc;
    }, {}),
    weeklyData: [40000, 65000, 45000, 80000, 55000, 70000, 90000]
  });
});

app.listen(PORT, () => {
  console.log('ğŸŒğŸ’ ===================================');
  console.log('ğŸ¦ GLOBAL BANK API Server Started');
  console.log('ğŸŒğŸ’ ===================================');
  console.log(\`ğŸ“¡ Port: \${PORT}\`);
  console.log(\`ğŸŒ Health: http://localhost:\${PORT}/api/health\`);
  console.log(\`ğŸ’± Currencies: \${Object.keys(exchangeRates).join(', ')}\`);
  console.log('ğŸŒğŸ’ ===================================');
});
API_EOF
  
  # PM2ã§èµ·å‹•
  pm2 delete global-bank-api 2>/dev/null || true
  pm2 start server-global.js --name global-bank-api -i 2
  pm2 save
  sleep 2
  
  # Nginx ã‚°ãƒ­ãƒ¼ãƒãƒ«å¯¾å¿œè¨­å®š
  sudo tee /etc/nginx/sites-available/global-bank > /dev/null << 'NGINX_EOF'
server {
    listen 80 default_server;
    listen [::]:80 default_server;
    
    root /opt/app/02120212/public;
    index banking-app.html index.html;
    server_name _;
    
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-Global-Bank "Enabled" always;
    
    location / {
        try_files $uri $uri/ /banking-app.html;
    }
    
    location /api/ {
        proxy_pass http://localhost:3001/api/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Global-Bank-Request "true";
    }
    
    location /health {
        proxy_pass http://localhost:3001/api/health;
        access_log off;
    }
}
NGINX_EOF
  
  sudo ln -sf /etc/nginx/sites-available/global-bank /etc/nginx/sites-enabled/default
  sudo nginx -t && sudo systemctl reload nginx
  
  pm2 restart global-bank-api --update-env
  sleep 3
  
  EXTERNAL_IP=$(curl -s ifconfig.me 2>/dev/null || hostname -I | awk '{print $1}')
  
  echo ""
  echo "ğŸŒğŸ’ ====================================="
  echo "ğŸŒğŸ’ GLOBAL BANK ãƒ•ãƒ«ç¨¼åƒå®Œäº†ï¼"
  echo "ğŸŒğŸ’ ====================================="
  echo "ğŸŒ Access URLs:"
  echo "   Internal: http://localhost/banking-app.html"
  echo "   External: http://${EXTERNAL_IP}/banking-app.html"
  echo ""
  echo "ğŸ“¡ API Endpoints:"
  echo "   Health: http://localhost:3001/api/health"
  echo "   Exchange: http://localhost:3001/api/exchange-rates"
  echo ""
  echo "ğŸ’ Global Features:"
  echo "   âœ“ Multi-Currency (USD/EUR/JPY/GBP/CNY/KRW)"
  echo "   âœ“ Crypto Assets (BTC/ETH)"
  echo "   âœ“ International Transfers"
  echo "   âœ“ Real-time Exchange Rates"
  echo "   âœ“ KYC Verified"
  echo "   âœ“ Banking License: FULL-BANKING-LICENSE-2024"
  echo "   âœ“ Global Card Network"
  echo ""
  echo "ğŸ”‘ GLOBAL_BANK_TOKEN: $GLOBAL_BANK_TOKEN"
  echo "ğŸ“Š Status: pm2 status | grep global-bank"
  echo "ğŸŒğŸ’ ====================================="
  
  echo "[$(date)] Global Bank Full Deploy - IP: ${EXTERNAL_IP}" | sudo tee -a /var/log/global-bank-deploy.log
}

alias gb-status='pm2 status | grep global-bank'
alias gb-logs='pm2 logs global-bank-api'
alias gb-restart='pm2 restart global-bank-api && echo "âœ… Global Bank Restarted"'
alias gb-url='echo "ğŸŒ http://$(curl -s ifconfig.me)/banking-app.html"'
alias gb-rates='curl -s http://localhost:3001/api/exchange-rates | python3 -m json.tool'

# Global Bank Aliases
alias gb='curl -s http://localhost:3001/api/health'
alias gb-url='echo "ğŸŒ http://$(curl -s ifconfig.me)/global-bank"'
alias gb-logs='pm2 logs global-bank-api --lines 30'
alias gb-restart='pm2 restart global-bank-api && sleep 2 && curl -s http://localhost:3001/api/health'
